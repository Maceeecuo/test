>>> import numpy as np
>>> import pandas as pd
>>> from pandas import Series,DataFrame
>>> import matplotlib.pyplot as plt
>>> file='D:\python\pra\CDNOW.txt'
>>> df=pd.read_csv(file,sep='\s+',header=None,
		   names=['user','date','quantity','price'])
>>> df.head()
   user      date  quantity  price
0     1  19970101         1  11.77
1     2  19970112         1  12.00
2     2  19970112         5  77.00
3     3  19970102         2  20.76
4     3  19970330         2  20.76
>>> df.isnull().sum()
user        0
date        0
quantity    0
price       0
dtype: int64
>>> df.price.describe()
count    69659.000000
mean        35.893648
std         36.281942
min          0.000000
25%         14.490000
50%         25.980000
75%         43.700000
max       1286.010000
Name: price, dtype: float64
>>> df.quantity.describe()
count    69659.000000
mean         2.410040
std          2.333924
min          1.000000
25%          1.000000
50%          2.000000
75%          3.000000
max         99.000000
Name: quantity, dtype: float64
>>> df.groupby('date').sum()
             user  quantity     price
date                                 
19970101    26084       494   7515.35
19970102    91156       530   8025.95
19970103   146344       495   7475.04
19970104   150310       404   6722.93
19970105   276888       590   9274.80
19970106   359135       620   9680.55
19970107   343701       494   7741.19
19970108   421389       515   7963.14
19970109   481231       482   7534.92
19970110   518151       533   8348.59
19970111   731703       661  10275.10
19970112   765514       625   9866.16
19970113   741899       540   8869.69
19970114   786906       501   7787.84
19970115   842892       503   8034.40
19970116   939010       489   7663.30
19970117  1011663       666  10021.51
19970118  1265905       712  10744.70
19970119  1482268       738  10735.22
19970120  1572752       739  11015.44
19970121  1428367       665   9860.57
19970122  1346649       606   9445.97
19970123  1585686       649   9966.24
19970124  1982408       759  11880.27
19970125  1790920       676  10211.46
19970126  2129373       836  12689.15
19970127  2293654       839  12898.44
19970128  2161680       689  10642.29
19970129  2581071       839  12628.84
19970130  2585534       792  12114.58
...           ...       ...       ...
19980601   865774       235   3174.43
19980602   801012       200   2743.69
19980603  1136738       238   3380.46
19980604   914197       216   2942.97
19980605   983502       168   2637.84
19980606   842647       206   2922.49
19980607   693159       164   2232.65
19980608   877012       164   2398.48
19980609   800129       227   3161.39
19980610  1203712       362   5166.61
19980611  1294033       264   3692.45
19980612   836703       156   2683.08
19980613   638881       117   2209.32
19980614   785365       245   3631.15
19980615   964122       220   3168.52
19980616   870539       209   2869.26
19980617   771123       179   2763.06
19980618   722194       129   1820.33
19980619   555457       111   1651.66
19980620   549775       111   1579.15
19980621   592860       149   2032.98
19980622   727974       159   2384.43
19980623   628787       129   1902.93
19980624   556599       100   1378.28
19980625   465327       109   1377.47
19980626   528074       114   1646.63
19980627   784837       214   2985.14
19980628   563094        99   1388.44
19980629   740839       137   2003.36
19980630   677209       156   2180.65

[546 rows x 3 columns]
>>> df.groupby('date')['quantity'].sum()
date
19970101    494
19970102    530
19970103    495
19970104    404
19970105    590
19970106    620
19970107    494
19970108    515
19970109    482
19970110    533
19970111    661
19970112    625
19970113    540
19970114    501
19970115    503
19970116    489
19970117    666
19970118    712
19970119    738
19970120    739
19970121    665
19970122    606
19970123    649
19970124    759
19970125    676
19970126    836
19970127    839
19970128    689
19970129    839
19970130    792
           ... 
19980601    235
19980602    200
19980603    238
19980604    216
19980605    168
19980606    206
19980607    164
19980608    164
19980609    227
19980610    362
19980611    264
19980612    156
19980613    117
19980614    245
19980615    220
19980616    209
19980617    179
19980618    129
19980619    111
19980620    111
19980621    149
19980622    159
19980623    129
19980624    100
19980625    109
19980626    114
19980627    214
19980628     99
19980629    137
19980630    156
Name: quantity, Length: 546, dtype: int64
>>> df.groupby('date').max()
           user  quantity    price
date                              
19970101    245        27   363.60
19970102    519        14   199.15
19970103    778        10   143.38
19970104    985        15   216.94
19970105   1260        12   283.97
19970106   1529        16   283.97
19970107   1762        40   548.48
19970108   1990         9   136.28
19970109   2235        20   268.32
19970110   2467        16   242.28
19970111   2753        12   222.56
19970112   3024        20   241.39
19970113   3267        13   381.00
19970114   3504        10   194.00
19970115   3731         9   124.97
19970116   3992         8   140.37
19970117   4237        16   278.86
19970118   4523        19   296.50
19970119   4825        25   340.73
19970120   5130        15   207.51
19970121   5404        32   421.30
19970122   5645        11   153.06
19970123   5914        17   239.70
19970124   6219        14   211.72
19970125   6496        19   274.28
19970126   6795        24   364.37
19970127   7098        17   432.76
19970128   7369        22   382.62
19970129   7699        16   325.90
19970130   8010        22   305.48
...         ...       ...      ...
19980601  23198        21   248.79
19980602  23256        15   204.47
19980603  23075         9   153.39
19980604  22815        14   246.43
19980605  23425         8   133.82
19980606  22857        17   240.83
19980607  23556        12   136.88
19980608  23216         7   121.32
19980609  23380        25   350.66
19980610  23555        99  1286.01
19980611  23149        14   199.64
19980612  23394         7   366.98
19980613  23271         8   275.98
19980614  23513        18   252.68
19980615  23041         7   165.50
19980616  23443        14   199.54
19980617  22975        22   340.65
19980618  23369        10   143.90
19980619  23060         9   181.73
19980620  23162         8   100.92
19980621  23489        12   144.45
19980622  22802         9   148.53
19980623  23256        13   218.44
19980624  22508         9   108.41
19980625  23402        16   197.91
19980626  23162         7   103.82
19980627  23124        13   158.99
19980628  23444        12   164.47
19980629  21838         7   112.02
19980630  23149        10   200.57

[546 rows x 3 columns]
>>> df.groupby('date')['quantity'].max()
date
19970101    27
19970102    14
19970103    10
19970104    15
19970105    12
19970106    16
19970107    40
19970108     9
19970109    20
19970110    16
19970111    12
19970112    20
19970113    13
19970114    10
19970115     9
19970116     8
19970117    16
19970118    19
19970119    25
19970120    15
19970121    32
19970122    11
19970123    17
19970124    14
19970125    19
19970126    24
19970127    17
19970128    22
19970129    16
19970130    22
            ..
19980601    21
19980602    15
19980603     9
19980604    14
19980605     8
19980606    17
19980607    12
19980608     7
19980609    25
19980610    99
19980611    14
19980612     7
19980613     8
19980614    18
19980615     7
19980616    14
19980617    22
19980618    10
19980619     9
19980620     8
19980621    12
19980622     9
19980623    13
19980624     9
19980625    16
19980626     7
19980627    13
19980628    12
19980629     7
19980630    10
Name: quantity, Length: 546, dtype: int64
>>> df.groupby('user')['price'].max()
user
1         11.77
2         77.00
3         57.45
4         29.73
5         46.46
6         20.99
7        138.50
8         50.43
9         41.98
10        39.31
11        19.30
12        57.06
13        72.94
14        29.92
15        52.87
16        31.60
17        73.22
18        14.96
19       163.35
20       363.60
21        63.34
22        14.37
23        24.74
24        47.28
25        24.98
26        59.97
27        83.41
28        39.51
29        67.31
30        14.37
          ...  
23541     46.37
23542     77.43
23543     50.76
23544     48.68
23545     24.99
23546     13.97
23547     11.77
23548     23.54
23549     27.13
23550     25.28
23551    102.36
23552     26.93
23553     49.30
23554     24.60
23555     49.96
23556     45.74
23557     14.37
23558     48.22
23559     52.80
23560     18.36
23561     37.05
23562     29.33
23563     47.98
23564     46.47
23565     11.77
23566     36.00
23567     20.97
23568     83.74
23569     25.74
23570     51.12
Name: price, Length: 23570, dtype: float64
>>> df.groupby('date')['price'].max()
date
19970101     363.60
19970102     199.15
19970103     143.38
19970104     216.94
19970105     283.97
19970106     283.97
19970107     548.48
19970108     136.28
19970109     268.32
19970110     242.28
19970111     222.56
19970112     241.39
19970113     381.00
19970114     194.00
19970115     124.97
19970116     140.37
19970117     278.86
19970118     296.50
19970119     340.73
19970120     207.51
19970121     421.30
19970122     153.06
19970123     239.70
19970124     211.72
19970125     274.28
19970126     364.37
19970127     432.76
19970128     382.62
19970129     325.90
19970130     305.48
             ...   
19980601     248.79
19980602     204.47
19980603     153.39
19980604     246.43
19980605     133.82
19980606     240.83
19980607     136.88
19980608     121.32
19980609     350.66
19980610    1286.01
19980611     199.64
19980612     366.98
19980613     275.98
19980614     252.68
19980615     165.50
19980616     199.54
19980617     340.65
19980618     143.90
19980619     181.73
19980620     100.92
19980621     144.45
19980622     148.53
19980623     218.44
19980624     108.41
19980625     197.91
19980626     103.82
19980627     158.99
19980628     164.47
19980629     112.02
19980630     200.57
Name: price, Length: 546, dtype: float64
>>> df.groupby('date')['user'].count()
date
19970101    212
19970102    247
19970103    236
19970104    178
19970105    256
19970106    275
19970107    223
19970108    239
19970109    241
19970110    239
19970111    301
19970112    283
19970113    252
19970114    255
19970115    249
19970116    253
19970117    285
19970118    323
19970119    346
19970120    342
19970121    298
19970122    277
19970123    299
19970124    366
19970125    314
19970126    355
19970127    371
19970128    332
19970129    386
19970130    365
           ... 
19980601     80
19980602     67
19980603     97
19980604     84
19980605     76
19980606     76
19980607     63
19980608     73
19980609     75
19980610    106
19980611     99
19980612     70
19980613     57
19980614     75
19980615     91
19980616     80
19980617     64
19980618     63
19980619     47
19980620     49
19980621     50
19980622     68
19980623     55
19980624     44
19980625     44
19980626     47
19980627     73
19980628     50
19980629     62
19980630     58
Name: user, Length: 546, dtype: int64
>>> df.groupby('user').count()
       date  quantity  price
user                        
1         1         1      1
2         2         2      2
3         6         6      6
4         4         4      4
5        11        11     11
6         1         1      1
7         3         3      3
8         8         8      8
9         3         3      3
10        1         1      1
11        4         4      4
12        1         1      1
13        1         1      1
14        1         1      1
15        1         1      1
16        4         4      4
17        1         1      1
18        1         1      1
19        2         2      2
20        2         2      2
21        2         2      2
22        1         1      1
23        1         1      1
24        2         2      2
25        8         8      8
26        2         2      2
27        2         2      2
28        3         3      3
29       12        12     12
30        2         2      2
...     ...       ...    ...
23541     2         2      2
23542     1         1      1
23543     1         1      1
23544     3         3      3
23545     1         1      1
23546     1         1      1
23547     2         2      2
23548     1         1      1
23549     1         1      1
23550     1         1      1
23551     6         6      6
23552     2         2      2
23553     2         2      2
23554     2         2      2
23555     5         5      5
23556     7         7      7
23557     1         1      1
23558     4         4      4
23559     3         3      3
23560     1         1      1
23561     3         3      3
23562     1         1      1
23563     2         2      2
23564     3         3      3
23565     1         1      1
23566     1         1      1
23567     1         1      1
23568     3         3      3
23569     1         1      1
23570     2         2      2

[23570 rows x 3 columns]
>>> df['date']=pd.to_datetime(df['date'],format='%Y%m%d')
>>> df=df.set_index('date',drop=True)
>>> month_grouped=df.resample('m').agg({'user':'count','quantity':'sum','price':'sum'})
>>> month_grouped['user_sum']=df.resample('m')['user'].nunique()
>>> print(month_grouped)
             user  quantity      price  user_sum
date                                            
1997-01-31   8928     19416  299060.17      7846
1997-02-28  11272     24921  379590.03      9633
1997-03-31  11598     26159  393155.27      9524
1997-04-30   3781      9729  142824.49      2822
1997-05-31   2895      7275  107933.30      2214
1997-06-30   3054      7301  108395.87      2339
1997-07-31   2942      8131  122078.88      2180
1997-08-31   2320      5851   88367.69      1772
1997-09-30   2296      5729   81948.80      1739
1997-10-31   2562      6203   89780.77      1839
1997-11-30   2750      7812  115448.64      2028
1997-12-31   2504      6418   95577.35      1864
1998-01-31   2032      5278   76756.78      1537
1998-02-28   2026      5340   77096.96      1551
1998-03-31   2793      7431  108970.15      2060
1998-04-30   1878      4697   66231.52      1437
1998-05-31   1985      4903   70989.66      1488
1998-06-30   2043      5287   76109.30      1506
>>> df.drop_duplicates('user')['user'].resample('m').count()
date
1997-01-31    7846
1997-02-28    8476
1997-03-31    7248
Freq: M, Name: user, dtype: int64
